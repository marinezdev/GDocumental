
@{
    ViewBag.Title = "Nuevo Documento";
    Layout = "~/Views/Shared/_Layout _Administracion.cshtml";
} 

<link rel="stylesheet" href="~/assets/dist/themes/proton/style.css" />

<style>
    /* Personalizar el estilo del menú contextual */
    .vakata-context,
    .vakata-context ul {
        background-color: #fff; /* Fondo blanco */
        border: 1px solid #ccc; /* Borde gris */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Sombra ligera */
    }

        .vakata-context a {
            padding: 8px 12px;
            color: #333; /* Color de texto oscuro */
            transition: background-color 0.3s ease;
            display: block;
        }

            .vakata-context a:hover {
                background-color: #f0f0f0; /* Cambio de color al pasar el ratón */
            }

        /* Estilo específico para los íconos en el menú contextual */
        .vakata-context .vakata-contextmenu-item .vakata-contextmenu-icon {
            margin-right: 8px;
        }

        /* Estilo específico para la línea divisoria entre elementos del menú */
        .vakata-context .vakata-contextmenu-item .vakata-contextmenu-divider {
            height: 1px;
            background-color: #ccc;
            margin: 6px 0;
        }

    .fa-folder:before {
        color: #f3bb22;
        font-size: 16px;
    }
</style>
<style>


    .process-step .btn:focus {
        outline: none
    }

    .process {
        display: table;
        width: 100%;
        position: relative
    }

    .process-row {
        display: table-row
    }

    .process-step button[disabled] {
        opacity: 1 !important;
        filter: alpha(opacity=100) !important
    }

    .process-row:before {
        top: 40px;
        bottom: 0;
        position: absolute;
        content: " ";
        width: 100%;
        height: 1px;
        background-color: #ccc;
        z-order: 0
    }

    .process-step {
        display: table-cell;
        text-align: center;
        position: relative
    }

        .process-step p {
            margin-top: 4px
        }

    .btn-circle {
        width: 80px;
        height: 80px;
        text-align: center;
        font-size: 12px;
        border-radius: 50%
    }





    .TextoColor {
        color: #555 !important;
    }

    /* @@media (min-width: 768px) {
        .modal-dialog {
            width: 600px;
            margin: 150px auto;
        }
    }*/

    .close:not(:disabled):not(.disabled) {
        cursor: pointer;
    }

    .close {
        float: right;
        font-size: 1.5rem;
        font-weight: 700;
        line-height: 1;
        color: #000;
        text-shadow: 0 1px 0 #fff;
        opacity: .5;
    }

    progress {
        -webkit-appearance: none;
        border-radius: 15px;
    }

    ::-webkit-progress-bar {
        background-color: #ccc;
        border-radius: 15px;
    }


    progress[value]::-webkit-progress-value {
        background-image: -webkit-linear-gradient(-45deg, transparent 33%, rgba(0, 0, 0, .1) 33%, rgba(0,0, 0, .1) 66%, transparent 66%), -webkit-linear-gradient(top, rgba(255, 255, 255, .25), rgba(0, 0, 0, .25)), -webkit-linear-gradient(left, #01477f, #008c99);
        border-radius: 15px;
        background-size: 35px 20px, 100% 100%, 100% 100%;
    }



    .cogVcH:hover {
        cursor: pointer;
        border-style: solid;
    }

    .cogVcH {
        max-width: 180px;
        width: 100%;
        border: 1px dashed #448aff;
        color: #448aff;
        height: 216px;
        border-radius: 8px;
        padding: 10px;
        background-color: rgb(255, 255, 255);
        display: flex;
        flex-flow: column wrap;
        -webkit-box-align: center;
        align-items: center;
        -webkit-box-pack: center;
        justify-content: center;
        font-size: 1.2rem;
        margin-right: 10px;
        margin-bottom: 15px;
        -webkit-box-flex: 1;
        flex-grow: 1;
        transition: border 0.25s ease-in-out 0s;
    }

    .gXEoDm {
        width: 180px;
        height: 216px;
        border: 0.5px solid rgb(124, 152, 167);
        border-radius: 8px;
        background-color: rgb(255, 255, 255);
        display: flex;
        flex-direction: column;
        margin-right: 10px;
        margin-bottom: 15px;
        position: relative;
    }

    .sc-fATqzn:hover .fpCmKW {
        visibility: visible;
        top: -16px;
    }

    .fpCmKW {
        position: absolute;
        width: 100%;
        text-align: right;
        z-index: 3;
        top: 0px;
        visibility: hidden;
        transition: visibility 0s ease-out 0s;
        box-sizing: border-box;
        overflow: hidden;
    }

    .ecdNeI {
        width: 48px;
        height: 48px;
        cursor: pointer;
        display: inline-block;
        background-image: url(/panel/static/media/R-PANELv2.06.1-RC1/icon_rotate_48x48.2dfac1f1.svg);
        background-size: cover;
        margin-right: 4px;
    }

    .ecdNeI2 {
        width: 48px;
        height: 48px;
        cursor: pointer;
        display: inline-block;
        background-image: url(/panel/static/media/R-PANELv2.06.1-RC1/icon_rotate_48x48.2dfac1f1.svg);
        background-size: cover;
        margin-right: 4px;
    }


    .fpCmKW span:last-child {
        margin: 0px;
    }

    .jskYLk {
        width: 48px;
        height: 48px;
        cursor: pointer;
        display: inline-block;
        background-size: cover;
        margin-right: 4px;
        background-image: url('../../Images/icons/icon_trash_48x48.e4cbe3f0.svg');
    }

    .gsEJWt {
        width: 100%;
        height: 30px;
        color: white;
        font-size: 12px;
        font-weight: 500;
        padding: 5px 10px;
        background-image: linear-gradient( 310deg, #ff0049 0%, #990051 100%);
        border-radius: 8px 8px 0px 0px;
        text-align: center;
        position: absolute;
        z-index: 2;
        display: flex;
        -webkit-box-pack: center;
        justify-content: center;
        -webkit-box-align: center;
        align-items: center;
    }

    .iOCuAz {
        border-radius: 8px 0px 8px 0px 0px;
        overflow: hidden;
        width: 180px;
        height: 215px;
        transition: height 1s ease 0s;
    }

    .gnckKk {
        width: 178px;
        height: 215px;
        object-fit: cover;
        transition: height 1s ease 0s;
        border-radius: 8px;
    }

    .hZRbtg input, .hZRbtg select, .hZRbtg textarea {
        font-family: Hind;
        font-weight: 400;
        font-size: 14px;
    }

    .ldkJDz {
        display: block;
        width: 100%;
        padding: 0px 67px 0px;
        margin-top: 40px;
        white-space: normal;
        min-height: 692px;
        font-family: Hind;
        overflow-x: hidden;
    }

    .ihwDZV {
        padding: 40px 40px 45px;
        white-space: normal;
    }

    .hZRbtg {
        box-shadow: rgb(0 0 0 / 8%) -1px 2px 20px 0px;
        border-radius: 12px;
        width: 100%;
        white-space: normal;
    }

    .hZRbtg {
        box-shadow: rgb(0 0 0 / 8%) -1px 2px 20px 0px;
        border-radius: 12px;
        width: 100%;
        white-space: normal;
    }

    .dUQJCE {
        height: 35px;
        width: 172px;
        text-overflow: ellipsis;
        border-radius: 0px 0px 8px 8px;
        margin: 0px 5px;
        color: rgb(104, 128, 140);
        font-size: 12px !important;
    }

    .sc-fATqzn:hover .fpCmKW {
        visibility: visible;
        top: -16px;
    }


    .fpCmKW {
        position: absolute;
        width: 100%;
        text-align: right;
        z-index: 3;
        top: 0px;
        visibility: hidden;
        transition: visibility 0s ease-out 0s;
        box-sizing: border-box;
        overflow: hidden;
    }

    .ecdNeI:hover {
        background-image: url('../../Images/icons/icon_rotate_48x48_hover.1e032e91.svg');
    }

    .ecdNeI {
        width: 48px;
        height: 48px;
        cursor: pointer;
        display: inline-block;
        background-image: url('../../Images/icons/icon_rotate_48x48.2dfac1f1.svg');
        background-size: cover;
        margin-right: 4px;
    }

    .ecdNeI2:hover {
        background-image: url('../../Images/icons/icon_subir.png');
    }

    .ecdNeI2 {
        width: 48px;
        height: 48px;
        cursor: pointer;
        display: inline-block;
        background-image: url('../../Images/icons/icon_subir_hover.png');
        background-size: cover;
        margin-right: 4px;
    }

    .gsEJWt div {
        height: 14px;
        width: 14px;
        margin-bottom: 4px;
        background-image: url('../../Images/icons/star.9fe16126.svg');
        background-size: cover;
        margin-right: 8px;
    }

    .faMYgb {
        max-height: 250px;
        width: 100%;
        margin: 0px;
        padding: 0px;
        box-sizing: content-box;
        display: flex;
        flex-direction: column;
        -webkit-box-pack: justify;
        justify-content: space-between;
        transition: max-height 1s ease 0s;
        overflow: hidden;
    }

    .gJWAcE {
        width: 100%;
        padding: 30px 0px 0px px;
        display: flex;
        -webkit-box-pack: start;
        justify-content: flex-start;
        flex-flow: row wrap;
        transition: max-height 1s ease 0s;
    }

    .fpCmKW span:last-child {
        margin: 0px;
    }


    .jskYLk:hover {
        background-image: url('../../Images/icons/icon_trash_48x48_hover.d8eb4bff.svg');
    }

    .btn-info.active, .btn-info:active, .show > .btn-info.dropdown-toggle {
        background-color: #448aff;
        background-image: none;
        border-color: #3f629d;
    }

    select.form-control, select.form-control:focus, select.form-control:hover {
        border-top: 1px;
        border-right: 1px;
        border-left: 1px;
        border: 1px solid #cccccc;
        border-radius: 2px;
    }

    select.form-control:not([size]):not([multiple]) {
        height: 36px;
    }

    .table td, .table th {
        padding: 0.25rem 0.75rem;
    }
    .alert-warning {
        background-color: #78beff54;
        border-color: #00aeff;
        color: #ffe100;
        font-weight: bold;
        font-size: 13px;
        color: black;
    }
</style>

<div class="@*pcoded-content*@">
    <!-- Page-header start -->
    <div class="page-header">
        <div class="page-block">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <div class="page-header-title">
                        <h5 class="m-b-10"> <i class="fa fa-plus" aria-hidden="true"></i>   Nuevo Documento </h5>
                        <p class="m-b-0"> </p>
                    </div>
                </div>
                <div class="col-md-4">
                    <ul class="breadcrumb-title">
                        <li class="breadcrumb-item">
                            <a href="/Administracion/PrincipalA"> <i class="fa fa-home"></i> </a>
                        </li>
                        <li class="breadcrumb-item">
                            <a href="#!">Nuevo Documento </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="pcoded-inner-content">
        <!-- Main-body start -->
        <div class="main-body">
            <div class="page-wrapper">
                <!-- Page-body start -->
                <div class="page-body">

                    <div class="row">
                        <div class="col-sm-12">

                            <!-- Basic Form Inputs card start -->
                            <div class="card">
                                <div class="card-header">
                                    <h5>Nuevo Documento  </h5>
                                    <span>Completa los campos marcados *</span>
                                </div>
                                <div class="card-block">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            @*INICIO  BARRA DE PROGRESO*@
                                            <div class="process">
                                                <div class="process-row nav nav-tabs">
                                                    <div class="process-step text-center">
                                                        <button type="button" class="btn btn-info btn-circle" data-toggle="tab" href="#menu1"><i class="fa fa-pencil-square-o fa-3x text-center"></i></button>
                                                        <p>Descripción</p>
                                                    </div>
                                                    <div class="process-step">
                                                        <button type="button" class="btn btn-default btn-circle" data-toggle="tab" href="#menu2"><i class="fa fa-file-text-o fa-3x"></i></button>
                                                        <p>Control</p>
                                                    </div>
                                                    <div class="process-step">
                                                        <button type="button" class="btn btn-default btn-circle" data-toggle="tab" href="#menu3"><i class="fa fa-exchange fa-3x"></i></button>
                                                        <p>Distribución </p>
                                                    </div>
                                                    <div class="process-step">
                                                        <button type="button" class="btn btn-default btn-circle" data-toggle="tab" href="#menu4" onclick="CargaResumen()"><i class="fa fa-file-pdf-o fa-3x"></i></button>
                                                        <p>Clasificación</p>
                                                    </div>
                                                    <div class="process-step">
                                                        <button type="button" class="btn btn-default btn-circle" data-toggle="tab" href="#menu5" onclick="CargaResumen()"><i class="fa fa-upload fa-3x"></i></button>
                                                        <p>Publicar</p>
                                                    </div>
                                                </div>
                                            </div>
                                            @*FIN BARRA DE PROGRESO*@
                                            <div class="tab-content">
                                                <div id="menu1" class="tab-pane fade active in">
                                                    <br />
                                                    <div class="row">
                                                        <div class="col-md-12 text-center">
                                                            <h3>Descripción </h3>
                                                            <div id="DatosRequeridos" class="alert alert-warning" role="alert" style="display:none">
                                                                <p>
                                                                    El tipo de documento seleccionado requiere los siguientes datos:
                                                                </p>

                                                                <div class="row">
                                                                    <div class="col-5">
                                                                        <div>
                                                                            <p><i class="fa fa-files-o" aria-hidden="true"></i> Archivos</p>
                                                                            <a id="mensaje"><strong>* Archivo editable</strong></a>
                                                                            <a ><strong>* Archivo PDF</strong></a>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-2"></div>
                                                                    <div class="col-5">
                                                                        <div>
                                                                            <p><i class="fa fa-calendar" aria-hidden="true"></i> Fechas</p>
                                                                            <a id="FechaRevisionCC"><strong>* Revisión</strong></a>
                                                                            <a id="FechaPublicacionCC"><strong>* Publicacion</strong></a>
                                                                            <a id="FechadeentradaenvigorCC"><strong>* Entrada en vigor</strong></a>
                                                                            <a id="FechaProximaRevisionCC"><strong>* Proxima Revisión</strong></a>
                                                                            <a id="FechaVencimientoCC"><strong>* Vencimiento</strong></a>
                                                                        </div>
                                                                    </div>

                                                                </div>                                                             
                                                            </div>

                                                                
                                                        </div>
                                                    </div>
                                                    <br />

                                                    <div class="row">

                                                        <div class="col-md-4 col-lg-4">
                                                            <div class="form-group">
                                                                <label for="largeInput">* Nombre (titulo) </label>
                                                                <input type="text" name="message" onkeyup="countChars(this)" ; class="form-control form-control input-number" id="NombreDocumento">
                                                                <p id="charNum"></p>
                                                            </div>
                                                        </div>

                                                        <div class="col-md-4 col-lg-4">
                                                            <div class="form-group">
                                                                <label for="largeInput">* Versión </label>
                                                                <input type="number" min="1" class="form-control form-control input-number" id="Version">
                                                            </div>
                                                        </div>

                                                        <div class="col-md-4 col-lg-4">
                                                            <div class="form-group">
                                                                <label for="largeInput">* Tipo Documento </label>
                                                                <select class="form-control" id="TipoDocumento" onchange="ValidaTDoc(this.value),Fechas(this.value)">
                                                                    <option value="0">Seleccionar</option>
                                                                    @foreach (var item1 in ViewBag.dtTipoDocumentos)
                                                                    {
                                                                        <option value="@item1.Id">@item1.Nombre</option>
                                                                    }
                                                                </select>
                                                            </div>
                                                        </div>

                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-4 col-lg-4">
                                                            <div class="form-group">
                                                                <label for="largeInput">* Palabra Clave </label>
                                                                <input type="text" class="form-control form-control input-number" id="PalabraClave">
                                                            </div>
                                                        </div>
                                                        <div class="col-md-8 col-lg-8">
                                                            <div class="form-group">
                                                                <label for="largeInput">* Descripción </label>
                                                                <textarea class="form-control" id="Descripcion" rows="3"></textarea>
                                                            </div>
                                                        </div>

                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-12 col-lg-12">
                                                            <button class="btn waves-effect waves-light btn-primary col-md-2" onclick="Descripcion()">  Siguiente   <i class="fa fa-chevron-right"></i></button>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div id="menu2" class="tab-pane fade">
                                                    <br />
                                                    <div class="row">
                                                        <div class="col-md-12 text-center">
                                                            <h3>Control</h3>
                                                            @*<p> Agrega atributos adiciones, mejora las especificaciones del artículo. Completa los campos marcados * </p>*@
                                                        </div>
                                                    </div>
                                                    <br />
                                                    <div class="row">
                                                        <div class="col-md-4 col-lg-4" id="FRevision">
                                                            <div class="form-group">
                                                                <label for="largeInput">* Fecha Revisión </label>
                                                                <input type="text" class="form-control form-control input-number" id="FechaRevision" onkeypress="return soloNum(event)">
                                                            </div>
                                                        </div>

                                                        <div class="col-md-4 col-lg-4" id="FPublicacion">
                                                            <div class="form-group">
                                                                <label for="largeInput">* Fecha Publicacion </label>
                                                                <input type="text" class="form-control form-control input-number" id="FechaPublicacion" onkeypress="return soloNum(event)">
                                                            </div>
                                                        </div>

                                                        <div class="col-md-4 col-lg-4" id="FEntradaVigor">
                                                            <div class="form-group">
                                                                <label for="largeInput">* Fecha de entrada en vigor </label>
                                                                <input type="text" class="form-control form-control input-number" id="Fechadeentradaenvigor" onkeypress="return soloNum(event)">
                                                            </div>
                                                        </div>

                                                        <div class="col-md-4 col-lg-4" id="FProximaRevision">
                                                            <div class="form-group">
                                                                <label for="largeInput">*Fecha de Proxima revisión</label>
                                                                <input type="text" class="form-control form-control input-number" id="FechaProximaRevision" onkeypress="return soloNum(event)">
                                                            </div>
                                                        </div>

                                                        <div class="col-md-4 col-lg-4" id="FVencimiento">
                                                            <div class="form-group">
                                                                <label for="largeInput">* Fecha Vencimiento</label>
                                                                <input type="text" class="form-control form-control input-number" id="FechaVencimiento" onkeypress="return soloNum(event)">
                                                            </div>
                                                        </div>



                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-12 col-lg-12">
                                                            @*validatodasfechas(), se quito la validacion de las fechas*@
                                                            <button class="btn waves-effect waves-light btn-inverse btn-outline-inverse col-md-2" onclick="Previus()"> <i class="fa fa-chevron-left"></i> Atrás   </button>
                                                            <button class="btn waves-effect waves-light btn-primary col-md-2" onclick="Control()">  Siguiente   <i class="fa fa-chevron-right"></i></button>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div id="menu3" class="tab-pane fade">
                                                    <br />
                                                    <div class="row">
                                                        <div class="col-md-12 text-center">
                                                            <h3>Distribución</h3>
                                                        </div>
                                                    </div>
                                                    <br />
                                                    <div class="row">

                                                        <div class="col-md-4 col-lg-4">
                                                            <div class="form-group">
                                                                <label for="largeInput">* Tipo Archivo </label>
                                                                <select class="form-control" id="Select_TipoArchivo">
                                                                    <option value="0">Seleccionar </option>
                                                                    @foreach (var item1 in ViewBag.dtTipoArchivo)
                                                                    {
                                                                        <option value="@item1.Id">@item1.Extension</option>
                                                                    }
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4 col-lg-4">
                                                            <div class="form-group">
                                                                <label for="largeInput">* Medio de Almacenamiento </label>
                                                                <select class="form-control" id="Select_MedioAlmacenamiento">
                                                                    <option value="0">Seleccionar </option>
                                                                    @foreach (var item1 in ViewBag.dtAlmacenamiento)
                                                                    {
                                                                        <option value="@item1.Id">@item1.Nombre</option>
                                                                    }
                                                                </select>
                                                            </div>
                                                        </div>


                                                        <div class="form-material col-md-2 col-lg-2">
                                                            <br /><br />
                                                            <div class="form-check">
                                                                <label class="form-check-label">
                                                                    <input name="checkboxCaracteristasEnvio" class="form-check-input" id="checkboxBD" type="checkbox" value="">
                                                                    <span class="form-check-sign">Base de datos</span>
                                                                </label>
                                                            </div>
                                                        </div>

                                                        <div class="form-material col-md-2 col-lg-2">
                                                            <br /><br />
                                                            <div class="form-check">
                                                                <label class="form-check-label">
                                                                    <input name="checkboxCaracteristasEnvio" class="form-check-input" id="checkboxCorreo" type="checkbox" value="">
                                                                    <span class="form-check-sign">Correo electrónico</span>
                                                                </label>
                                                            </div>
                                                        </div>

                                                        <div class="form-material col-md-2 col-lg-2" style="display:none">
                                                            <br />
                                                            <div class="form-check">
                                                                <label class="form-check-label">
                                                                    <input name="checkboxCustodia" class="form-check-input" id="checkboxCustodia" type="checkbox" value="">
                                                                    <span class="form-check-sign" title="Si el documento esta en tu custodia palomea esta opción">Custodia del documento</span>
                                                                </label>
                                                            </div>
                                                        </div>


                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-12 col-lg-12">
                                                            <button class="btn waves-effect waves-light btn-inverse btn-outline-inverse col-md-2" onclick="Previus()"> <i class="fa fa-chevron-left"></i> Atrás   </button>
                                                            <button class="btn waves-effect waves-light btn-primary col-md-2" onclick="Distribucion(),CargaResumen()">  Siguiente   <i class="fa fa-chevron-right"></i></button>
                                                        </div>
                                                    </div>

                                                </div>

                                                <div id="menu4" class="tab-pane fade">
                                                    <br />
                                                    @*TITULO PRINCIPAL*@
                                                    <div class="row">
                                                        <div class="col-md-12 text-center">
                                                            <h3>Clasificación y Carga de Archivo</h3>
                                                            <p>Selecciona la carpeta en la cual guardaras tu documento. Completa los campos marcados * </p>
                                                        </div>
                                                    </div>
                                                    <div class="row justify-content-start">

                                                        <div class="col-4 p-15 p-b-0">
                                                            <form class="form-material">
                                                                <div class="form-group form-primary">
                                                                    <input id="plugins4_q" type="text" name="footer-email" class="form-control" required="">
                                                                    <span class="form-bar"></span>
                                                                    <label class="float-label"><i class="fa fa-search m-r-10"></i>Buscar</label>
                                                                </div>
                                                            </form>
                                                        </div>

                                                    </div>
                                                    @*ELEMENTOS PRINCIPALES*@
                                                    <div class="row">

                                                        <div class="col-md-4" style="overflow:auto;">
                                                            <div class="card-body">
                                                                <div id="jstree">
                                                                    @Html.Raw(ViewBag.carpetas);
                                                                </div>


                                                            </div>
                                                        </div>

                                                        <div class="container col-md-4">
                                                            <br />
                                                            <div class="m-0 vh-100 row justify-content-center align-items-center">
                                                                <div class="col-md-6" id="Rpdf">
                                                                    <div data-repa="step2-images-collapseContainer" class="sc-cLxPOX">
                                                                        <div id="Galeria" data-repa="step2-images-filesContainer" class="sc-dTsoBL gJWAcE">
                                                                            <button type="button" onclick="BtnCargarPDF()" class="flex-c-m cl0 size-125 cogVcH bor2 hov-btn3 p-lr-15 trans-04">
                                                                                <i class="fa fa-plus-circle" aria-hidden="true"></i>&nbsp; Subir Archivo <br />
                                                                                <i style="font-size:38px; color:#F44336" class="fa fa-file-pdf-o" aria-hidden="true"></i>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                @*APARIENCIA DE SUBIDA DOCUMENTO Editable*@
                                                                <div class="col-md-6">
                                                                    <div data-repa="step2-images-collapseContainer" class="sc-cLxPOX" style="float:left">
                                                                        <div id="Word" data-repa="step2-images-filesContainer" class="sc-dTsoBL gJWAcE">
                                                                            <button type="button" onclick="BtnCargarWord()" class="flex-c-m cl0 size-125 cogVcH bor2 hov-btn3 p-lr-15 trans-04">
                                                                                <i class="fa fa-plus-circle" aria-hidden="true"></i>&nbsp; Subir Editable
                                                                                <div class="row">
                                                                                    <i style="font-size:38px;" class="fa fa-file-word-o"></i>
                                                                                    <i style="font-size:38px; color:limegreen" class="fa fa-file-excel-o"></i>
                                                                                    <i style="font-size: 38px; color:darkorange" class="fa fa-file-powerpoint-o"></i>
                                                                                </div>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            @*SELECT*@
                                                            <div class="row">
                                                                <div class="col-md-12 col-lg-12">
                                                                    <div class="form-group">
                                                                        <label for="largeInput">* Clasificación </label>
                                                                        <select class="form-control" id="Clasificacion">
                                                                            <option value="0">Seleccionar </option>
                                                                            @foreach (var item1 in ViewBag.dtClasificacion)
                                                                            {
                                                                                <option value="@item1.Id">@item1.Nombre</option>
                                                                            }
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            @if (((ProyectoBase.Models.Usuarios)System.Web.HttpContext.Current.Session["Sesion"]).IdRol == 3)
                                                            {
                                                                <div class="alert alert-info" role="alert">Haz clic derecho en la carpeta que desees editar</div>
                                                            }

                                                        </div>

                                                        @*IFRAME*@
                                                        <div class="col-md-4 container text-center">
                                                            <h5>PREVISUALIZACIÓN</h5>
                                                            <iframe id="iframepdf" width="90%" height="90%" frameborder="0"></iframe>
                                                        </div>

                                                    </div>

                                                    <br />
                                                    <br />
                                                    @*BARRA DE PROGRESO Y EL input de documento*@
                                                    <div class="row">
                                                        <input id="fileInput2" type="file" multiple style="visibility:hidden">
                                                        <input id="fileInputword" type="file" multiple style="visibility:hidden">

                                                        <div class="col-md-12">
                                                            <progress id="fileProgress" style="display: none; width:100%"></progress>
                                                        </div>
                                                    </div>
                                                    @*BOTONES*@
                                                    <div class="row">
                                                        <div class="col-md-12 col-lg-12">
                                                            <button class="btn waves-effect waves-light btn-inverse btn-outline-inverse col-md-2" onclick="Previus()"> <i class="fa fa-chevron-left"></i> Atrás   </button>
                                                            <button class="btn waves-effect waves-light btn-primary col-md-2" onclick="clasificacion(),CargaResumen()">  Siguiente   <i class="fa fa-chevron-right"></i></button>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div id="menu5" class="tab-pane fade text">
                                                    <br />
                                                    <div class="row">
                                                        <div class="col-md-12 text-center">
                                                            <h3>Resumen del Documento</h3>
                                                        </div>
                                                    </div>
                                                    <br />

                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <h4>DESCRIPCIÓN</h4>
                                                            <div class="resumen">
                                                                <br />
                                                                <p><strong>Nombre (titulo)</strong> <br /> <span id="SP_CategoriaArticulo"></span></p>
                                                                <p><strong>Versión</strong> <br /> <span id="SP_SubcategoriaArticulo"></span></p>
                                                                <p><strong>Tipo Documento</strong> <br /> <span id="SP_ClasificacionArticulo"></span></p>
                                                                <p><strong>Palabra Clave</strong> <br /> <span id="SP_FlujoOperacionArticulo"></span></p>
                                                                <p><strong>Descripción</strong> <br /> <span id="SP_Descripcion"></span></p>


                                                            </div>
                                                        </div>

                                                        <div class="col-md-4">
                                                            <h4><strong class="TextoColor">CONTROL </strong></h4>

                                                            <div class="resumen">
                                                                <p id="FechaRevisionC"><strong>Fecha Revisión</strong> <br /> <span id="SP_FechaRevision"></span></p>
                                                                <p id="FechaPublicacionC"><strong>Fecha Publicacion</strong> <br /> <span id="SP_FechaPublicacion"></span></p>
                                                                <p id="FechadeentradaenvigorC"><strong>Fecha de entrada en vigor</strong> <br /> <span id="SP_Fechadeentradaenvigor"></span></p>
                                                                <p id="FechaProximaRevisionC"><strong>Fecha Proxima Revisión</strong> <br /> <span id="SP_FechaProximaRevision"></span></p>
                                                                <p id="FechaVencimientoC"><strong>Fecha Vencimiento</strong> <br /> <span id="SP_FechaVencimiento"></span></p>


                                                            </div>

                                                        </div>

                                                        <div class="col-md-4">
                                                            <h4><strong class="TextoColor">DISTRIBUCIÓN </strong></h4>
                                                            <div class="resumen">
                                                                <p><strong>Tipo Archivo</strong> <br /> <span id="SP_Select_TipoArchivo"></span></p>
                                                                <p><strong>Medio de Almacenamiento</strong> <br /> <span id="SP_Select_MedioAlmacenamiento"></span></p>



                                                            </div>

                                                            <h4><strong class="TextoColor">CLASIFICACIÓN </strong> </h4>
                                                            <p><strong>Clasificación</strong> <br /> <span id="SP_Select_Clasificacion"></span></p>
                                                        </div>
                                                    </div>


                                                    <div class="row">
                                                        <div class="col-md-12 col-lg-12">
                                                            <button class="btn waves-effect waves-light btn-inverse btn-outline-inverse col-md-2" onclick="Previus()"> <i class="fa fa-chevron-left"></i> Atrás   </button>
                                                            <button class="btn waves-effect waves-light btn-success col-md-2" onclick="Publicar()" id="BtnPublicar"> <i class="fa fa-check"></i> Publicar    </button>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Basic Form Inputs card end -->
                            </div>
                        </div>

                    </div>
                    <!-- Page body end -->
                </div>
            </div>
        </div>
    </div>
</div>




<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>

    $(document).ready(function () {
        $('#Select_MedioAlmacenamiento').change(function () {
            var selectValue = $(this).val();
            var checkbox = $('#checkboxCustodia');

            if (selectValue === "2") {
                checkbox.prop('checked', true);
            } else {
                checkbox.prop('checked', false);
            }
        });
    });
    function Publicar() {

                if (ValidaDescripcion()) {

                    if (ValidaControl()) {

                        if (ValidaDistribucion()) {

                            if (Validaclasificacion()) {

                                if (ValidaDocumento()) {
                                    if (RequiereEditable()) {
                                        //EJECUCION DOCUMENTO CON EDITABLE
                                        if (ValidaDocumentoWord()) {
                                            $("#BtnPublicar").prop('disabled', true);

                                            var obj = {};
                                            obj['Nombre'] = $("#NombreDocumento").val();
                                            obj['Version'] = $("#Version").val();
                                            obj['IdTipoDocumento'] = $("#TipoDocumento option:selected").val();
                                            obj['PalabraClave'] = $("#PalabraClave").val();
                                            obj['Descripcion'] = $("#Descripcion").val();



                                            obj['FechaRevision'] = $("#FechaRevision").val();
                                            obj['Fechadeentradaenvigor'] = $("#Fechadeentradaenvigor").val();
                                            obj['FechaPublicacion'] = $("#FechaPublicacion").val();
                                            obj['FechaVencimiento'] = $("#FechaVencimiento").val();
                                            obj['FechaProximaRevision'] = $("#FechaProximaRevision").val();

                                            obj['IdTipoArchivo'] = $("#Select_TipoArchivo option:selected").val();
                                            obj['IdMedioAlmacenamiento'] = $("#Select_MedioAlmacenamiento option:selected").val();

                                            if ($('#checkboxBD').prop('checked')) {
                                                obj['checkboxBD'] = 1;
                                            } else {
                                                obj['checkboxBD'] = 0;
                                            }

                                            if ($('#checkboxCorreo').prop('checked')) {
                                                obj['checkboxCorreo'] = 1;
                                            } else {
                                                obj['checkboxCorreo'] = 0;
                                            }

                                            if ($('#checkboxCustodia').prop('checked')) {
                                                obj['checkboxCustodia'] = 1;
                                            } else {
                                                obj['checkboxCustodia'] = 0;
                                            }


                                            var node = $('#jstree').jstree().get_selected("id");
                                            obj['IdClasificacion'] = $("#Clasificacion option:selected").val();
                                            obj['Idtemporal'] = node[0].id;

                                            var jsonObject = {
                                                "NuevoDocumento": obj
                                            };
                                            $.ajax({
                                                type: "POST",
                                                url: "@Url.Action("Documentos_Registrar", "Documentos")",
                                                async: false,
                                                data: JSON.stringify(jsonObject),
                                                contentType: "application/json; charset=utf-8",
                                                dataType: "json",
                                                success: function (data) {
                                                    switch (data.Id) {
                                                        case -1:

                                                            swal({
                                                                title: "El Documento que intentas agregar ya se encuentra registrado .",
                                                                text: '',
                                                                icon: "warning",
                                                                button: "Aceptar",
                                                            });


                                                            break;
                                                        case 0:
                                                            swal({
                                                                title: "Algo ocurrió documento no registrado !",
                                                                text: '',
                                                                icon: "warning",
                                                                button: "Aceptar",
                                                            });
                                                            break;

                                                        default:
                                                        // code block
                                                    }
                                                    if (data.Id > 0) {
                                                        swal({
                                                            title: "Documento registrado. !",
                                                            text: " ",
                                                            icon: "success",
                                                            button: "Aceptar",
                                                        }).then((value) => {
                                                            location.reload();
                                                        });
                                                    }
                                                }
                                            });

                                            $("#BtnPublicar").prop('disabled', false);

                                        }

                                        else {
                                                swal({
                                                    title: "Documento faltante",
                                                    text: 'El tipo de documento que has seleccionado requiere de un documento editable',
                                                    icon: "warning",
                                                    button: "Aceptar"
                                                });

                                                $("#myBtn").trigger("click");
                                                $('.btn-circle.btn-info').removeClass('btn-info').addClass('btn-default');
                                                $('[href="#menu4"]').addClass('btn-info').removeClass('btn-default');
                                                $('[href="#menu4"]').tab('show');
                                        }
                                        //EJECUCION PROCEDIMIENTO SIN EDITABLE
                                    } else {
                                        $("#BtnPublicar").prop('disabled', true);

                                        var obj = {};
                                        obj['Nombre'] = $("#NombreDocumento").val();
                                        obj['Version'] = $("#Version").val();
                                        obj['IdTipoDocumento'] = $("#TipoDocumento option:selected").val();
                                        obj['PalabraClave'] = $("#PalabraClave").val();
                                        obj['Descripcion'] = $("#Descripcion").val();



                                        obj['FechaRevision'] = $("#FechaRevision").val();
                                        obj['Fechadeentradaenvigor'] = $("#Fechadeentradaenvigor").val();
                                        obj['FechaPublicacion'] = $("#FechaPublicacion").val();
                                        obj['FechaVencimiento'] = $("#FechaVencimiento").val();
                                        obj['FechaProximaRevision'] = $("#FechaProximaRevision").val();

                                        obj['IdTipoArchivo'] = $("#Select_TipoArchivo option:selected").val();
                                        obj['IdMedioAlmacenamiento'] = $("#Select_MedioAlmacenamiento option:selected").val();

                                        if ($('#checkboxBD').prop('checked')) {
                                            obj['checkboxBD'] = 1;
                                        } else {
                                            obj['checkboxBD'] = 0;
                                        }

                                        if ($('#checkboxCorreo').prop('checked')) {
                                            obj['checkboxCorreo'] = 1;
                                        } else {
                                            obj['checkboxCorreo'] = 0;
                                        }
                                        if ($('#checkboxCustodia').prop('checked')) {
                                            obj['checkboxCustodia'] = 1;
                                        } else {
                                            obj['checkboxCustodia'] = 0;
                                        }

                                        var node = $('#jstree').jstree().get_selected("id");
                                        obj['IdClasificacion'] = $("#Clasificacion option:selected").val();
                                        obj['Idtemporal'] = node[0].id;



                                        var jsonObject = {
                                            "NuevoDocumento": obj
                                        };
                                        $.ajax({
                                            type: "POST",
                                            url: "@Url.Action("Documentos_Registrar", "Documentos")",
                                            async: false,
                                            data: JSON.stringify(jsonObject),
                                            contentType: "application/json; charset=utf-8",
                                            dataType: "json",
                                            success: function (data) {
                                                switch (data.Id) {
                                                    case -1:

                                                        swal({
                                                            title: "El Documento que intentas agregar ya se encuentra registrado .",
                                                            text: '',
                                                            icon: "warning",
                                                            button: "Aceptar",
                                                        });


                                                        break;
                                                    case 0:
                                                        swal({
                                                            title: "Algo ocurrió documento no registrado !",
                                                            text: '',
                                                            icon: "warning",
                                                            button: "Aceptar",
                                                        });
                                                        break;

                                                    default:
                                                    // code block
                                                }
                                                if (data.Id > 0) {
                                                    swal({
                                                        title: "Documento registrado. !",
                                                        text: " ",
                                                        icon: "success",
                                                        button: "Aceptar",
                                                    }).then((value) => {
                                                        location.reload();
                                                    });
                                                }
                                            }

                                        });

                                        $("#BtnPublicar").prop('disabled', false);
                                    }

                                } else {
                                    swal({
                                        title: "Debes registrar un documento",
                                        text: '',
                                        icon: "warning",
                                        button: "Aceptar",
                                    });

                                    $("#myBtn").trigger("click");
                                    $('.btn-circle.btn-info').removeClass('btn-info').addClass('btn-default');
                                    $('[href="#menu4"]').addClass('btn-info').removeClass('btn-default');
                                    $('[href="#menu4"]').tab('show');
                                }
                            } else {
                                swal({
                                    title: "Debes completar el formulario de información.",
                                    text: '',
                                    icon: "warning",
                                    button: "Aceptar",
                                });

                                $("#myBtn").trigger("click");
                                $('.btn-circle.btn-info').removeClass('btn-info').addClass('btn-default');
                                $('[href="#menu4"]').addClass('btn-info').removeClass('btn-default');
                                $('[href="#menu4"]').tab('show');
                            }
                        }
                        else {
                            swal({
                                title: "Debes completar el formulario de información.",
                                text: '',
                                icon: "warning",
                                button: "Aceptar",
                            });

                            $("#myBtn").trigger("click");
                            $('.btn-circle.btn-info').removeClass('btn-info').addClass('btn-default');
                            $('[href="#menu3"]').addClass('btn-info').removeClass('btn-default');
                            $('[href="#menu3"]').tab('show');
                        }
                    } else {
                        swal({
                            title: "Debes completar el formulario de información.",
                            text: '',
                            icon: "warning",
                            button: "Aceptar",
                        });


                        $("#myBtn").trigger("click");
                        $('.btn-circle.btn-info').removeClass('btn-info').addClass('btn-default');
                        $('[href="#menu2"]').addClass('btn-info').removeClass('btn-default');
                        $('[href="#menu2"]').tab('show');
                    }
                }
                else {

                    swal({
                        title: "Debes completar el formulario de información.",
                        text: '',
                        icon: "warning",
                        button: "Aceptar",
                    });

                    $("#myBtn").trigger("click");
                    $('.btn-circle.btn-info').removeClass('btn-info').addClass('btn-default');
                    $('[href="#menu1"]').addClass('btn-info').removeClass('btn-default');
                    $('[href="#menu1"]').tab('show');
                }
    };

    $('#agregardoc').addClass("active");
    $('#menuDocumentos').addClass("active pcoded-trigger");
    $('#IdMenuProductos').addClass("active pcoded-trigger");
    $('#IdSubMenuNuevo').addClass("active");

    //////////////////////////
    function Nuevo() {
        $("#Modulo3er").css("display", "block");
        $("#NNivel").css("display", "none");


        var obj = {};
        obj['Id'] = $("#SubClasificacionArchivo option:selected").val();
        var jsonObject = {
            "Cat_ClasificacionArchivo": obj
        };

        $.ajax({
            type: "POST",
            url: "@Url.Action("SubClasificacionArchivo_Listar", "Documentos")",
            async: false,
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
               /* console.log(data);*/
                $("#Select3").empty();

                var option = $(document.createElement('option'));
                option.text("Seleccionar");
                option.val(0);

                $("#Select3").append(option);


                $(data).each(function () {
                    var option = $(document.createElement('option'));

                    option.text(this.Nombre);
                    option.val(this.Id);

                    $("#Select3").append(option);
                });

            }
        });
    }
    function Cancel3er() {
        $("#Modulo3er").css("display", "none");
        $("#NNivel").css("display", "block");
        $("#Select3").empty();

        var option = $(document.createElement('option'));
        option.text("Seleccionar");
        option.val(0);

        $("#Select3").append(option);
    }
    //Funcion Crearclasificacion
    function MostrarInfo() {

        $('#ModalClasificacion').modal('show');
    }
    function GuardarClas(data) {
       /* console.log(data);*/
        var obj = { "Nombre": data.node.text, "Id": 0 };

        var jsonObject = {
            "nuevaClas": obj
        };
                    $.ajax({
                type: "POST",
                url: "@Url.Action("RegistrarClas", "Documentos")",
                async: false,
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {

                    $("#BtnClasificacion").trigger("click");
                    if (data.Id == 1) {
                        swal({
                            title: "Clasificacion Agregada. !",
                            text: " ",
                            icon: "success",
                            button: "Aceptar",
                        });

                    }
                    else {

                        swal({
                            title: "Esta clasificación ya existe.",
                            text: '',
                            icon: "warning",
                            button: "Aceptar",
                        });
                    }

                }
            });

    }
    function validaClasificacionArchivo() {

        var result = false;

        $('#NombreClas').css("border", "1px solid #ff0049");


        if ($('#NombreClas').val().length > 0) {
            $('#NombreClas').css("border", "1px solid #cccccc");
        }

        if ($('#NombreClas').val().length > 0) {
           result = true;
        }

        return result;
    }

    function CrearSubclas() {
        if (validaseleccionclas()) {
            $('#ModalSUbClasificacion').modal('show');
        } else {
            swal({
                title: "Selecciona antes una clasificación .",
                text: '',
                icon: "warning",
                button: "Aceptar",
            });

        }
    }

    function validaSubClasificacionArchivo() {
        var result = false;

        $('#NombreSubClas').css("border", "1px solid #ff0049");


        if ($('#NombreSubClas').val().length > 0) {
            $('#NombreSubClas').css("border", "1px solid #cccccc");
        }

        if ($('#NombreSubClas').val().length > 0) {
            result = true;
        }

        return result;
    }


    function validaseleccionclas() {
        var result = false;

        $('#ClasificacionArchivo').css("border", "1px solid #ff0049");

        if ($("#ClasificacionArchivo option:selected").val() > 0) {
            $('#ClasificacionArchivo').css("border", "1px solid #cccccc");
        }
        if ($("#ClasificacionArchivo option:selected").val() > 0) {
            result = true;
        }
        return result;
    }

    function Crear3er() {
        if (validaseleccionSubclas()) {
            $('#Modal3er').modal('show');
        } else {
            swal({
                title: "Selecciona antes una Sub Clasificación .",
                text: '',
                icon: "warning",
                button: "Aceptar",
            });

        }
    }
    function validaseleccionSubclas() {
        var result = false;

        $('#SubClasificacionArchivo').css("border", "1px solid #ff0049");

        if ($("#SubClasificacionArchivo option:selected").val() > 0) {
            $('#SubClasificacionArchivo').css("border", "1px solid #cccccc");
        }
        if ($("#SubClasificacionArchivo option:selected").val() > 0) {
            result = true;
        }
        return result;
    }
    function Guardar3er() {
        if (valida3ermodal()) {

            var obj = {};
            obj['Id'] = $("#SubClasificacionArchivo option:selected").val();
            obj['Nombre'] = $("#Nombre3er").val();

            var jsonObject = {
                "nuevasubClas": obj
            };


            $.ajax({
                type: "POST",
                url: "@Url.Action("RegistrarSubClas", "Documentos")",
                async: false,
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {

                    $("#Btn3er").trigger("click");

                    if (data.Id == 1) {
                        swal({
                            title: "3er nivel Agregado. !",
                            text: " ",
                            icon: "success",
                            button: "Aceptar",
                        });

                    }
                    else {
                        swal({
                            title: "Este nivel ya existe.",
                            text: '',
                            icon: "warning",
                            button: "Aceptar",
                        });
                    }

                    // llenar select Subclasificacion -

                    var obj = {};
                    obj['Id'] = $("#SubClasificacionArchivo option:selected").val();
                    var jsonObject = {
                        "Cat_ClasificacionArchivo": obj
                    };

                    console.log(jsonObject);

                    $.ajax({
                        type: "POST",
                        url: "@Url.Action("SubClasificacionArchivo_Listar", "Documentos")",
                        async: false,
                        data: JSON.stringify(jsonObject),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (data) {
                            /*console.log(data);*/
                            $("#Select3").empty();



                            var option = $(document.createElement('option'));
                            option.text("Seleccionar");
                            option.val(0);

                            $("#Select3").append(option);


                            $(data).each(function () {
                                var option = $(document.createElement('option'));

                                option.text(this.Nombre);
                                option.val(this.Id);

                                $("#Select3").append(option);
                            });

                        }
                    });
                }

            });

        } else {}
    }
    function valida3ermodal() {
        var result = false;

        $('#Nombre3er').css("border", "1px solid #ff0049");


        if ($('#Nombre3er').val().length > 0) {
            $('#Nombre3er').css("border", "1px solid #cccccc");
        }

        if ($('#Nombre3er').val().length > 0) {
            result = true;
        }

        return result;
    }

    function Selecionar() {
        var d = document.getElementById("ClasificacionArchivo");
        var display = d.options[d.selectedIndex].text;
        document.getElementById("txtvalue").value = display;

    }

    function Selecionar3er() {
        var d = document.getElementById("SubClasificacionArchivo");
        var display = d.options[d.selectedIndex].text;
        document.getElementById("txtvalue3er").value = display;

    }


    //Funcion para cargar documento
    function BtnCargarPDF() {
        $("#fileInput2").click();
    };

    $('#fileInput2').change(function () {
        var fileInput = document.getElementById('fileInput2');

        if (fileInput.files.length > 0) {
            for (i = 0; i < fileInput.files.length; i++) {
                var ext = fileInput.files[i].name.split('.').pop();
                Extencion = fileInput.files[i].name.split('.').pop();

                // Convertimos en minúscula porque la extensión del archivo puede estar en mayúscula
                ext = ext.toLowerCase();

                if (ext == 'pdf' || ext == 'pdf' || ext == 'pdf') {

                    Carga = true;
                } else {
                    Carga = false;
                    Formato = ext;
                    break;
                }
            }

            for (i = 0; i < fileInput.files.length; i++) {
                var filesize = ((fileInput.files[i].size / 1024) / 1024).toFixed(4);

                if (filesize < 60) {
                    CargaTam = true;
                } else {
                    CargaTam = false;
                    Tam = filesize;
                    break;
                }
            }

            if (Carga) {
                if (CargaTam) {

                    $("#BtnCargarPDF").prop('disabled', true);
                    var formData = new FormData();

                    for (i = 0; i < fileInput.files.length; i++) {
                        formData.append(fileInput.files[i].name, fileInput.files[i]);
                    }

                    $.ajax({
                        url: '/api/FileAPI/UploadFilesArticulo',
                        type: 'POST',
                        data: formData,
                        cache: false,
                        contentType: false,
                        processData: false,
                        success: function (ListDocumentos) {
                            $("#fileProgress").hide();
                            $("#BtnCargarPDF").prop('disabled', false);

                            CargaDocumento(ListDocumentos);

                        },
                        xhr: function () {

                            var fileXhr = $.ajaxSettings.xhr();
                            if (fileXhr.upload) {
                                $("progress").show();
                                fileXhr.upload.addEventListener("progress", function (e) {
                                    if (e.lengthComputable) {
                                        $("#fileProgress").attr({
                                            value: e.loaded,
                                            max: e.total
                                        });
                                    }
                                }, false);
                            }
                            return fileXhr;
                        }
                    });


                } else {
                    swal({
                        title: "Intentas cargar una archivo muy pesada: " + Tam + " MG",
                        text: "Límite permitido 60 MB",
                        icon: "warning",
                        button: "Aceptar",
                    });
                }
            } else {
                swal({
                    title: "Intentas cargar un formato no permitido: " + Formato,
                    text: "Formato de archivos permitidos: .pdf ",
                    icon: "warning",
                    button: "Aceptar",
                });
            }

        } else {
            $("#BtnCargarPDF").prop('disabled', false);
            $.notify({
                message: "Selecciona un archivo."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }
    });

    function CargaDocumento(ListDocumentos) {

        $.ajax({
            type: "POST",
            url: "@Url.Action("CargaDocumentos", "Documentos")",
            async: false,
            data: JSON.stringify(ListDocumentos),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (Contenido) {
                PintaNuevoArchivo(Contenido);

                //PintaGaleria(Contenido);
	        },
            error: function (Contenido) {
                alert("error")
            }
        });
    }

    //FUNCION QUE CARGA WORD
    function BtnCargarWord() {
        $("#fileInputword").click();
    };

    $('#fileInputword').change(function () {
        var fileInput = document.getElementById('fileInputword');

        if (fileInput.files.length > 0) {
            for (i = 0; i < fileInput.files.length; i++) {
                var ext = fileInput.files[i].name.split('.').pop();
                Extencion = fileInput.files[i].name.split('.').pop();

                ext = ext.toLowerCase();

                if (ext == 'docx' || ext == 'pptx' || ext == 'xlsx' || ext == 'dwg') {

                    Carga = true;
                } else {
                    Carga = false;
                    Formato = ext;
                    break;
                }
            }

            for (i = 0; i < fileInput.files.length; i++) {
                var filesize = ((fileInput.files[i].size / 1024) / 1024).toFixed(4);

                if (filesize < 61) {
                    CargaTam = true;
                } else {
                    CargaTam = false;
                    Tam = filesize;
                    break;
                }
            }

            if (Carga) {
                if (CargaTam) {

                    $("#BtnCargarWord").prop('disabled', true);
                    var formData = new FormData();

                    for (i = 0; i < fileInput.files.length; i++) {
                        formData.append(fileInput.files[i].name, fileInput.files[i]);
                    }

                    $.ajax({
                        url: '/api/FileAPI/SubirWord',
                        type: 'POST',
                        data: formData,
                        cache: false,
                        contentType: false,
                        processData: false,
                        success: function (ListDocumentos) {
                            $("#fileProgress").hide();
                            $("#BtnCargarWord").prop('disabled', false);

                            CargaDocumentoword(ListDocumentos);

                        },
                        xhr: function () {

                            var fileXhr = $.ajaxSettings.xhr();
                            if (fileXhr.upload) {
                                $("progress").show();
                                fileXhr.upload.addEventListener("progress", function (e) {
                                    if (e.lengthComputable) {
                                        $("#fileProgress").attr({
                                            value: e.loaded,
                                            max: e.total
                                        });
                                    }
                                }, false);
                            }
                            return fileXhr;
                        }
                    });


                } else {
                    swal({
                        title: "Intentas cargar un archivo muy pesado: " + Tam + " MG",
                        text: "Límite permitido 60 MB",
                        icon: "warning",
                        button: "Aceptar",
                    });
                }
            } else {
                swal({
                    title: "Intentas cargar un formato no permitido: " + Formato,
                    text: "Formato de documentos permitidos: .docx, .pptx, .xlsx, .dwg ",
                    icon: "warning",
                    button: "Aceptar",
                });
            }

        } else {
            $("#BtnCargarWord").prop('disabled', false);
            $.notify({
                message: "Selecciona un archivo."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }
    });

    function CargaDocumentoword(ListDocumentos) {

        $.ajax({
            type: "POST",
            url: "@Url.Action("CargaDocumentosword", "Documentos")",
            async: false,
            data: JSON.stringify(ListDocumentos),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (Contenido) {
                swal({
                    title: "Documento cargado. !",
                    text: " ",
                    icon: "success",
                    button: "Aceptar",
                })
	        },
            error: function (Contenido) {

                $.notify("Completa el formulario.", "error");
            }
        });
    }
    function ValidaDocumentoWord() {
        var result = false;

        $.ajax({
            type: "POST",
            url: "@Url.Action("ConsultaDocumentosSesionWord", "Documentos")",
            async: false,
            data: "",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (respuesta) {
                if (respuesta.length > 0) {
                    result = true;
                }
            },
            error: function () {
                Error();
            }
        });

        return result;
    }
    function RequiereEditable() {
        var result = false;

        var obj = {};

        obj['Id'] = $("#TipoDocumento option:selected").val();

        var jsonObject = {
            "TDoc": obj
        };

        $.ajax({
            type: "POST",
            url: "@Url.Action("RequiereEditable", "Documentos")",
            async: false,
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data.Id === 1) {
                    result = true;
                } else {
                    return result;
                }

            }

        });

        return result;
    }


    function ValidaTDoc(Id) {
        
        $("#DatosRequeridos").css("display", "block");
        var obj = {};

        obj['Id'] = Id;

        var jsonObject = {
            "TDoc": obj
        };

        $.ajax({
            type: "POST",
            url: "@Url.Action("RequiereEditable", "Documentos")",
            async: false,
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data.Id === 1) {
                    $("#Word").css("display", "block");
                    $("#Rpdf").addClass("col-md-6");
                    $("#Rpdf").removeClass("col-md-12");

                    //Mostrar mensaje
                    $("#mensaje").css("display", "block");

                } else {
                    $("#Word").css("display", "none");
                    $("#Rpdf").addClass("col-md-12");

                    $("#mensaje").css("display", "none");
                }

            }

        });
    }


    //Funcion para trazar frame pdf
    function PintaNuevoArchivo(Contenido)
    {
        var mail = "https://" + Contenido[0].DocumentoURL + "#toolbar=0";

        $('#iframepdf').attr('src', mail);

    }

    /*SCRIPS Validación*/
    function Descripcion() {

        if (ValidaDescripcion()) {

            Next();
        } else {

            $.notify("Completa el formulario.", "error");
        }
    }
    function Control() {
        if (ValidaControl()) {
            Next();
        } else { }
    }
    function Distribucion() {
        if (ValidaDistribucion()) {
            Next();
        } else {
            $.notify("Completa el formulario.", "error");
        }
    }
    function clasificacion() {
        if (Validaclasificacion()) {

            Next();
        } else {
            $.notify("Completa el formulario.", "error");
        }
    }

    function ValidaDescripcion() {

            var result = false;


            $('#TipoDocumento').css("border", "1px solid #ff0049");
            $('#Version').css("border", "1px solid #ff0049");
            $('#NombreDocumento').css("border", "1px solid #ff0049");
            $('#PalabraClave').css("border", "1px solid #ff0049");
            $('#Descripcion').css("border", "1px solid #ff0049");


            if ($("#TipoDocumento option:selected").val() > 0) {
                $('#TipoDocumento').css("border", "1px solid #cccccc");
            }

            if ($('#Version').val().length > 0) {
                $('#Version').css("border", "1px solid #cccccc");
            }

            if ($('#NombreDocumento').val().length > 0) {
                $('#NombreDocumento').css("border", "1px solid #cccccc");
            }
            if ($('#PalabraClave').val().length > 0) {
                $('#PalabraClave').css("border", "1px solid #cccccc");
            }
            if ($('#Descripcion').val().length > 0) {
                $('#Descripcion').css("border", "1px solid #cccccc");
            }


            if ($("#TipoDocumento option:selected").val() > 0) {
                if ($('#Version').val().length > 0) {
                    if ($('#NombreDocumento').val().length > 0) {
                        if ($('#PalabraClave').val().length > 0) {
                            if ($('#Descripcion').val().length > 0) {
                                result = true;
                            }
                        }

                    }
                }
            }

            return result;
    }

    function ValidaDistribucion() {
            var result = false;

            $('#Select_TipoArchivo').css("border", "1px solid #ff0049");
            $('#Select_MedioAlmacenamiento').css("border", "1px solid #ff0049");

            if ($("#Select_TipoArchivo option:selected").val() > 0) {
                $('#Select_TipoArchivo').css("border", "1px solid #cccccc");
            }


            if ($("#Select_MedioAlmacenamiento option:selected").val() > 0) {
                $('#Select_MedioAlmacenamiento').css("border", "1px solid #cccccc");
            }



            if ($("#Select_TipoArchivo option:selected").val() > 0) {
                if ($("#Select_MedioAlmacenamiento option:selected").val()  > 0) {
                        result = true;
                }
            }

            return result;
        }
    function Validaclasificacion() {
            var result = false;

            var node = $('#jstree').jstree().get_selected("id");
            $('#Clasificacion').css("border", "1px solid #ff0049");

            if ($("#Clasificacion option:selected").val() > 0) {
                $('#Clasificacion').css("border", "1px solid #cccccc");
            }
            if (node == "") {
                swal({
                    title: "Selecciona la carpeta donde guardaras tu documento.",
                    text: '',
                    icon: "warning",
                    button: "Aceptar",
                });
            }


            if ($("#Clasificacion option:selected").val() > 0) {
                if (!node == "") {
                    $.notify("El documento se guardara en la carpeta: " + node[0].text, "info");

                    result = true;
                }

            }


            return result;
        }
    function ValidaDocumento() {
        var result = false;

        $.ajax({
            type: "POST",
            url: "@Url.Action("ConsultaDocumentosSesion", "Documentos")",
            async: false,
            data: "",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (respuesta) {
                if (respuesta.length > 0) {
                    result = true;
                }
            },
            error: function () {
                Error();
            }
        });

        return result;
    }


    /*Consultar subclasificacion select*/
    function ConsultaSubClasificacion(Id) {
        $('#SubClasificacionArchivo').empty();

        //ValidaSelect('Select_Categoria');

        var obj = {};
        obj['Id'] = Id;
        var jsonObject = {
            "Cat_ClasificacionArchivo": obj
        };

        $.ajax({
            url: "@Url.Action("SubClasificacionArchivo_Listar", "Documentos")",
            type: "POST",
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            error: function (resultado) {

                var option = $(document.createElement('option'));
                option.text("Seleccionar");
                option.val(0);

                $("#SubClasificacionArchivo").append(option);
            },
            success: function (resultado) {

                var option = $(document.createElement('option'));

                option.text("Seleccionar");
                option.val(0);


                $("#SubClasificacionArchivo").append(option);

                $(resultado).each(function () {
                    var option = $(document.createElement('option'));
                    option.text(this.Nombre);
                    option.val(this.Id);

                    $("#SubClasificacionArchivo").append(option);
                });
            }
        });
    }

    function Consulta3er(Id) {
        $('#Select3').empty();

        //ValidaSelect('Select_Categoria');

        var obj = {};
        obj['Id'] = Id;
        var jsonObject = {
            "Cat_ClasificacionArchivo": obj
        };

        $.ajax({
            url: "@Url.Action("SubClasificacionArchivo_Listar", "Documentos")",
            type: "POST",
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            error: function (resultado) {

                var option = $(document.createElement('option'));
                option.text("Seleccionar");
                option.val(0);

                $("#Select3").append(option);
            },
            success: function (resultado) {

                var option = $(document.createElement('option'));

                option.text("Seleccionar");
                option.val(0);


                $("#Select3").append(option);

                $(resultado).each(function () {
                    var option = $(document.createElement('option'));
                    option.text(this.Nombre);
                    option.val(this.Id);

                    $("#Select3").append(option);
                });
            }
        });
    }

    function callSubCategoria(Id) {
        $("#Select_SubCategoria").empty();
        $("#Select_Clasificacion").empty();

        ValidaSelect('Select_Categoria');


        var obj = {};
        obj['Id'] = Id;
        var jsonObject = {
            "Cat_CategoriaProducto": obj
        };

        $.ajax({
            url: "@Url.Action("SubCategoria_Listar", "Categoria")",
            type: "POST",
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            error: function (resultado) {
                alert("MANDAR MENSAJE SE ERROR");

                var option = $(document.createElement('option'));
                option.text("Seleccionar");
                option.val(0);

                var option2 = $(document.createElement('option'));
                option2.text("Seleccionar");
                option2.val(0);

                $("#Select_SubCategoria").append(option);
                $("#Select_Clasificacion").append(option2);
            },
            success: function (resultado) {

                var option = $(document.createElement('option'));

                option.text("Seleccionar");
                option.val(0);

                var option2 = $(document.createElement('option'));
                option2.text("Seleccionar");
                option2.val(0);

                $("#Select_SubCategoria").append(option);
                $("#Select_Clasificacion").append(option2);

                $(resultado).each(function () {
                    var option = $(document.createElement('option'));
                    option.text(this.Nombre);
                    option.val(this.Id);

                    $("#Select_SubCategoria").append(option);
                });
            }
        });


    }

    function callClasificacion(Id) {

        $("#Select_Clasificacion").empty();
        ValidaSelect('Select_SubCategoria');

        var obj = {};
        obj['IdCatSubcategoria'] = Id;
        var jsonObject = {
            "Cat_Clasificacion": obj
        };

        $.ajax({
            url: "@Url.Action("Clasificacion_Listar", "Categoria")",
            type: "POST",
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            error: function (resultado) {
                alert("MANDAR MENSAJE SE ERROR");

                var option = $(document.createElement('option'));
                option.text("Seleccionar");
                option.val(0);

                $("#Select_Clasificacion").append(option);
            },
            success: function (resultado) {
                var option = $(document.createElement('option'));
                option.text("Seleccionar");
                option.val(0);

                $("#Select_Clasificacion").append(option);

                $(resultado).each(function () {
                    var option = $(document.createElement('option'));
                    option.text(this.Nombre);
                    option.val(this.Id);

                    $("#Select_Clasificacion").append(option);
                });
            }
        });
    }
    /*Conteo caracteres*/
    function countChars(obj) {
        var maxLength = 150;
        var strLength = obj.value.length;
        var charRemain = (maxLength - strLength);

        if (charRemain < 0) {
            document.getElementById("charNum").innerHTML = '<span style="color: red;">Has superado el límite de ' + maxLength + ' carácteres</span>';
        } else {
            document.getElementById("charNum").innerHTML = charRemain + ' Carácteres restantes';
        }
    }

    /*CARGAR RESUMEN*/
    function CargaResumen(){
        @*var Galeria = 0;
        $.ajax({
            type: "POST",
             url: "@Url.Action("ConsultaImagenes", "Articulos")",
             async: false,
            data: "",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (respuesta) {
                Galeria = respuesta.length;
            },
            error: function () {
                Error();
            }
        });*@

        //$('#SP_CategoriaArticulo').text($("#Select_Categoria option:selected").html());
        //$('#SP_SubcategoriaArticulo').text($("#Select_SubCategoria option:selected").html());
        /*$('#SP_FlujoOperacionArticulo').text($("#Select_FlujoOperacion option:selected").html());*/
        $('#SP_CategoriaArticulo').text($("#NombreDocumento").val());
        $('#SP_Nombre').text($("#NombreDocumento").val());
        $('#SP_SubcategoriaArticulo').text($("#Version").val());
        $('#SP_ClasificacionArticulo').text($("#TipoDocumento  option:selected").html());
        $('#SP_FlujoOperacionArticulo').text($("#PalabraClave").val());
        $('#SP_Descripcion').text($("#Descripcion").val());
        $('#SP_Descripcion2').text($("#Descripcion").val());



        $('#SP_FechaRevision').text($("#FechaRevision").val());
        $('#SP_Fechadeentradaenvigor').text($("#Fechadeentradaenvigor").val());
        $('#SP_FechaPublicacion').text($("#FechaPublicacion").val());
        $('#SP_FechaVencimiento').text($("#FechaVencimiento").val());
        $('#SP_FechaProximaRevision').text($("#FechaProximaRevision").val());

        $('#SP_Select_TipoArchivo').text($("#Select_TipoArchivo option:selected").html());
        $('#SP_Select_MedioAlmacenamiento').text($("#Select_MedioAlmacenamiento option:selected").html());

        $('#SP_Select_Clasificacion').text($("#Clasificacion option:selected").html());


        //$('#SP_Select_ClasificacionArchivo').text($("#ClasificacionArchivo option:selected").html());
        //$('#SP_Select_SubClasificacionArchivo').text($("#SubClasificacionArchivo option:selected").html());
        //$('#SP_Select_Seccion').text($("#Select3 option:selected").html());

    }

    /*Botones siguiente y atras*/
    function Next() {
        var $activeTab = $('.tab-pane.active');
        $("#myBtn").trigger("click");
        $('.btn-circle.btn-info').removeClass('btn-info').addClass('btn-default');

        var nextTab = $activeTab.next('.tab-pane').attr('id');
        $('[href="#' + nextTab + '"]').addClass('btn-info').removeClass('btn-default');
        $('[href="#' + nextTab + '"]').tab('show');
    }
    function Previus() {
        var $activeTab = $('.tab-pane.active');
        $("#myBtn").trigger("click");
        $('.btn-circle.btn-info').removeClass('btn-info').addClass('btn-default');

        var prevTab = $activeTab.prev('.tab-pane').attr('id');
        $('[href="#' + prevTab + '"]').addClass('btn-info').removeClass('btn-default');
        $('[href="#' + prevTab + '"]').tab('show');

    }


    $(document).ready(function () {
        $('.btn-circle').on('click', function () {
            $('.btn-circle.btn-info').removeClass('btn-info').addClass('btn-default');
            $(this).addClass('btn-info').removeClass('btn-default').blur();
        });


        $('[href="#menu1"]').tab('show');

        $.datepicker.regional['es'] = {
            closeText: 'Cerrar',
            prevText: '< Ant',
            nextText: 'Sig >',
            currentText: 'Hoy',
            monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
            monthNamesShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
            dayNames: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
            dayNamesShort: ['Dom', 'Lun', 'Mar', 'Mié', 'Juv', 'Vie', 'Sáb'],
            dayNamesMin: ['Do', 'Lu', 'Ma', 'Mi', 'Ju', 'Vi', 'Sá'],
            weekHeader: 'Sm',
            dateFormat: 'dd/mm/yy',
            firstDay: 1,
            isRTL: false,
            showMonthAfterYear: false,
            yearSuffix: '',
            showAnim: 'slide'
        };
        $.datepicker.setDefaults($.datepicker.regional['es']);
        $(function () {
            $("#fecha").datepicker();
        });

        $("#FechaVencimiento").datepicker();
        $("#FechaProximaRevision").datepicker();
        $("#Fechadeentradaenvigor").datepicker();
        $("#FechaPublicacion").datepicker();
        $("#FechaRevision").datepicker();


    });
    const Nombre = document.getElementById('NombreDocumento');
    Nombre.addEventListener('keyup', function () {
        const text = Nombre.value;
        const uppercaseText = text.toUpperCase();
        Nombre.value = uppercaseText;
    });
    const PalabraClave = document.getElementById('PalabraClave');
    PalabraClave.addEventListener('keyup', function () {
        const text = PalabraClave.value;
        const uppercaseText = text.toUpperCase();
        PalabraClave.value = uppercaseText;
    });
    const Descripciones = document.getElementById('Descripcion');
    Descripciones.addEventListener('keyup', function () {
        const text = Descripciones.value;
        const uppercaseText = text.toUpperCase();
        Descripciones.value = uppercaseText;
    });
</script>

<!--ARBOL-->
<script>
    $(document).ready(function () {
        var treeList = @Html.Raw(Json.Encode(ViewBag.ElementoOculto));

        var treeAdminExists = treeList.some(function(item) {
            return item.IdElemento === "TreeAdmin";
        });

        if (treeAdminExists) {
            $(function () {

                $('#jstree').jstree({

                    'core': { 
                        'themes': {
                            'name': 'proton',
                            'responsive': true
                        },
                        'check_callback': true
                    },

                    'plugins': ['contextmenu', 'dnd', 'state', 'wholerow', 'search'],

                    "contextmenu": {
                        items: {
                            "ccp": false,
                            "create": {
                                "label": "Crear carpeta",
                                "action":
                                    function node_create() {
                                        var ref = $("#jstree").jstree(true);
                                        var sel = ref.get_selected();

                                        if (!sel.length) {
                                            alert("Seleccione primero un nodo");
                                            return;
                                        }
                                        sel = sel[0];
                                        sel = ref.create_node(sel);

                                        var nuevo = $("#jstree").jstree(true).get_node(sel);

                                        var obj = {
                                            "Nombre": nuevo.text, "IdPadre": nuevo.parent, "Idtemporal": nuevo.id
                                        };

                                        var jsonObject = {
                                            "nuevasubClas": obj
                                        };


                                        $.ajax({
                                            type: "POST",
                                            url: "@Url.Action("RegistrarSubClas", "Documentos")",
                                            async: false,
                                            data: JSON.stringify(jsonObject),
                                            contentType: "application/json; charset=utf-8",
                                            dataType: "json",
                                            success: function (data) {

                                                $("#BtnSubclas").trigger("click");

                                                if (data.Id == 1) {


                                                    if (sel) {
                                                        ref.edit(sel);
                                                    }
                                                }
                                                else {

                                                    ref.delete_node(sel);
                                                }

                                            }

                                        });


                                    }
                            },
                            "renombrar": {
                                "label": "Renombrar Carpeta",
                                "action": function node_rename() {

                                    var ref = $("#jstree").jstree(true);
                                    var sel = ref.get_selected();
                                    if (!sel.length) {
                                        alert("Seleccione primero un nodo");
                                        return;
                                    }
                                    sel = sel[0];
                                    ref.edit(sel);
                                }
                            },
                            "eliminar": {
                                "label": "Eliminar Carpeta",
                                "action": function node_delete() {
                                    var ref = $("#jstree").jstree(true);
                                    var sel = ref.get_selected();

                                    var obj = { "Idtemporal": sel[0] };
                                    var jsonObject = {
                                        "carpeta": obj
                                    };

                                    $.ajax({
                                        type: "POST",
                                        url: "@Url.Action("EliminarCarpeta", "Documentos")",
                                        async: false,
                                        data: JSON.stringify(jsonObject),
                                        contentType: "application/json; charset=utf-8",
                                        dataType: "json",
                                        success: function (data) {


                                            if (data.Id == 1) {
                                                sel = sel[0];

                                                ref.delete_node(sel);
                                                $.notify("Carpeta eliminada!", "success");
                                            }
                                            else {
                                                swal({
                                                    title: "Esta carpeta no se puede eliminar ya que existe información que depende de esta.",
                                                    text: '',
                                                    icon: "warning",
                                                    button: "Aceptar",
                                                });
                                            }

                                        }

                                    });



                                }
                            },
                            "carpetaRoot": {
                                "label": "Crear carpeta principal",
                                "action": function () {
                                    $("#jstree").jstree("create_node", null, null, "last", function (node) {

                                        var obj = {
                                            "Nombre": node.text, "Idtemporal": node.id
                                        };

                                        var jsonObject = {
                                            "nuevaClas": obj
                                        };
                                        $.ajax({
                                            type: "POST",
                                            url: "@Url.Action("RegistrarClas", "Documentos")",
                                            async: false,
                                            data: JSON.stringify(jsonObject),
                                            contentType: "application/json; charset=utf-8",
                                            dataType: "json",
                                            success: function (data) {

                                                if (data.Id == 1) {


                                                }
                                                else {

                                                    $.notify("El nombre de esta carpeta ya esta en uso renombrela.", "error");
                                                }

                                            }
                                        });

                                        this.edit(node);

                                    });
                                }
                            }
                        }
                    },

                });
                var to = false;
                $('#plugins4_q').keyup(function () {
                    if (to) { clearTimeout(to); }
                    to = setTimeout(function () {
                        var v = $('#plugins4_q').val();
                        $('#jstree').jstree(true).search(v);
                    }, 250);
                });

                $('#jstree').on('rename_node.jstree', function (e, data) {

                    const node = data.node;
                    const newName = data.text.toUpperCase();
                    node.text = newName;

                    var obj = { "Nombre": data.node.text, "Idtemporal": data.node.id, "IdPadre": data.node.parent };
                    var jsonObject = {
                        "carpeta": obj
                    };


                    $.ajax({
                        type: "POST",
                        url: "@Url.Action("Renombrar", "Documentos")",
                        async: false,
                        data: JSON.stringify(jsonObject),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (data) {

                            $("#BtnSubclas").trigger("click");

                            if (data.Id == 1) {

                                $.notify("Cambios Realizados.", "success");
                            }
                            else {

                                $.notify("El nombre de esta carpeta ya esta en uso renombrela.", "error");
                                ref.edit(sel);
                            }

                        }

                    });
                });

                $('#jstree').bind('move_node.jstree', function (e, data) {


                    if (data.node.parent == '#') {
                        var obj = { "Idtemporal": data.node.id, "IdPadre": '0' };
                        var jsonObject = {
                            "NdN": obj
                        };
                    }
                    else {
                        var obj = { "Idtemporal": data.node.id, "IdPadre": data.node.parent };
                        var jsonObject = {
                            "NdN": obj
                        };
                    }


                    $.ajax({
                        type: "POST",
                        url: "@Url.Action("MoverRutasDocumentos", "Documentos")",
                        async: false,
                        data: JSON.stringify(jsonObject),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (data) {

                            $("#BtnSubclas").trigger("click");

                            if (data.Id == 1) {

                                $.notify("Carpeta Reubicada.", "success");
                            }
                            else {

                                $.notify("No es posible mover a esta ruta.", "error");
                            }

                        }

                    });
                });
            });
        }
        else {
            $(function () {

                $('#jstree').jstree({

                    'core': { 
                        'themes': {
                            'name': 'proton',
                            'responsive': true
                        },
                        'check_callback': true
                    },

                    'plugins': ['state', 'wholerow', 'search'],

                });
                var to = false;
                $('#plugins4_q').keyup(function () {
                    if (to) { clearTimeout(to); }
                    to = setTimeout(function () {
                        var v = $('#plugins4_q').val();
                        $('#jstree').jstree(true).search(v);
                    }, 250);
                });

            });
        }
            
        
    });
</script>



<script>
//INICIO Consultar fechas requeribles
    function Fechas(Id) {

        $("#FechaRevision").val("");
        $("#Fechadeentradaenvigor").val("");
        $("#FechaPublicacion").val("");
        $("#FechaProximaRevision").val("");
        $("#FechaVencimiento").val("");

        var obj = {};
        obj['Id'] = Id;
        var jsonObject = { "documento": obj };

        $.ajax({
            type: "POST",
            url: "@Url.Action("FechaInterfaz", "Documentos")",
            async: false,
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data[0].FRevision == 1) {
                    $("#FechaRevisionC").css("display", "block");
                    $("#FRevision").css("display", "block");
                    $("#FechaRevisionCC").css("display", "block");
                } else {
                    $("#FechaRevisionC").css("display", "none");
                    $("#FRevision").css("display", "none");
                    $("#FechaRevisionCC").css("display", "none");
                }
                if (data[0].FEntradaVigor == 1) {
                    $("#FechadeentradaenvigorC").css("display", "block");
                    $("#FEntradaVigor").css("display", "block");
                    $("#FechadeentradaenvigorCC").css("display", "block");
                } else {
                    $("#FechadeentradaenvigorC").css("display", "none");
                    $("#FEntradaVigor").css("display", "none");
                    $("#FechadeentradaenvigorCC").css("display", "none");
                }
                if (data[0].FPublicacion == 1) {
                    $("#FechaPublicacionC").css("display", "block");
                    $("#FPublicacion").css("display", "block");
                    $("#FechaPublicacionCC").css("display", "block");
                } else {
                    $("#FechaPublicacionC").css("display", "none");
                    $("#FPublicacion").css("display", "none");
                    $("#FechaPublicacionCC").css("display", "none");
                }
                if (data[0].FProximaRevision == 1) {
                    $("#FechaProximaRevisionC").css("display", "block");
                    $("#FProximaRevision").css("display", "block");
                    $("#FechaProximaRevisionCC").css("display", "block");
                } else {
                    $("#FechaProximaRevisionC").css("display", "none");
                    $("#FProximaRevision").css("display", "none");
                    $("#FechaProximaRevisionCC").css("display", "none");
                }
                if (data[0].FVencimiento == 1) {
                    $("#FechaVencimientoC").css("display", "block");
                    $("#FVencimiento").css("display", "block");
                    $("#FechaVencimientoCC").css("display", "block");

                } else {
                    $("#FechaVencimientoC").css("display", "none");
                    $("#FVencimiento").css("display", "none");
                    $("#FechaVencimientoCC").css("display", "none");
                }
            }
        });
    }
//FIN Consultar fechas requeribles

// INICIO VALIDAR FECHAS REQUERIDAS
function ValidaControl() {
    var result = true;

    var obj = {};
    obj['Id'] = $("#TipoDocumento option:selected").val();
    var jsonObject = { "documento": obj };

    $.ajax({
        type: "POST",
        url: "@Url.Action("FechaInterfaz", "Documentos")",
        async: false,
        data: JSON.stringify(jsonObject),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (data) {
            // Reset the border color for all fields
            $('#FechaRevision, #Fechadeentradaenvigor, #FechaPublicacion, #FechaVencimiento, #FechaProximaRevision')
                .css("border", "1px solid #cccccc");

            if (data[0].FRevision === 1 && $('#FechaRevision').val().length === 0) {
                $('#FechaRevision').css("border", "1px solid #ff0049");
                result = false;
            }
            if (data[0].FEntradaVigor === 1 && $('#Fechadeentradaenvigor').val().length === 0) {
                $('#Fechadeentradaenvigor').css("border", "1px solid #ff0049");
                result = false;
            }
            if (data[0].FPublicacion === 1 && $('#FechaPublicacion').val().length === 0) {
                $('#FechaPublicacion').css("border", "1px solid #ff0049");
                result = false;
            }
            if (data[0].FProximaRevision === 1 && $('#FechaProximaRevision').val().length === 0) {
                $('#FechaProximaRevision').css("border", "1px solid #ff0049");
                result = false;
            }
            if (data[0].FVencimiento === 1 && $('#FechaVencimiento').val().length === 0) {
                $('#FechaVencimiento').css("border", "1px solid #ff0049");
                result = false;
            }
        }
    });

    return result;
}
// FIN VALIDAR FECHAS REQUERIDAS



//INICIO VALIDAR FECHAS
function validatodasfechas() {

        if (validarFechaRevision()) {

            if (validarFechaPublicacion()) {

                if (validarFechadeentradaenvigor()) {

                    if (validarFechaVencimiento()) {

                        if (validarFechaProximaRevision()) {
                            Next();


                        } else {
                            $.notify("Completa el formulario.", "error");
                        }



                    } else {

                        $.notify("Completa el formulario.", "error");
                    }

                } else {

                    $.notify("Completa el formulario.", "error");
                }

            } else {

                $.notify("Completa el formulario.", "error");
            }

        } else {

            $.notify("Completa el formulario.", "error");
        }
    }

function validarFechaRevision() {
    var result = false;

    var fechaRevisionInput = $('#FechaRevision').val();
    var fechaRevisionParts = fechaRevisionInput.split('/');
    var fechaRevision = new Date(fechaRevisionParts[2], fechaRevisionParts[1] - 1, fechaRevisionParts[0]);

    var fechaPublicacionInput = $('#FechaPublicacion').val();
    var fechaPublicacionParts = fechaPublicacionInput.split('/');
    var fechaPublicacion = new Date(fechaPublicacionParts[2], fechaPublicacionParts[1] - 1, fechaPublicacionParts[0]);

    var fechaEntradaEnVigorInput = $('#Fechadeentradaenvigor').val();
    var fechaEntradaEnVigorParts = fechaEntradaEnVigorInput.split('/');
    var fechaEntradaEnVigor = new Date(fechaEntradaEnVigorParts[2], fechaEntradaEnVigorParts[1] - 1, fechaEntradaEnVigorParts[0]);

    var fechaVencimientoInput = $('#FechaVencimiento').val();
    var fechaVencimientoParts = fechaVencimientoInput.split('/');
    var fechaVencimiento = new Date(fechaVencimientoParts[2], fechaVencimientoParts[1] - 1, fechaVencimientoParts[0]);

    if (fechaRevision <= fechaPublicacion) {
        if (fechaRevision < fechaEntradaEnVigor) {
            if (fechaRevision < fechaVencimiento) {
                result = true;
            } else {
                $.notify("La Fecha de Revisión debe ser menor a la Fecha de Vencimiento.", "warn");
            }
        } else {
            $.notify("La Fecha de Revisión debe ser menor a la Fecha de entrada en vigor.", "warn");
        }
    } else {
        $.notify("La Fecha de Revisión debe ser menor a la Fecha de Publicación.", "warn");
    }

    console.log(fechaRevision);
    console.log(fechaPublicacion);
    console.log(fechaEntradaEnVigor);
    console.log(fechaVencimiento);

    return result;
}
function validarFechaPublicacion() {
    var result = false;

    var fechaPublicacionInput = $('#FechaPublicacion').val();
    var fechaPublicacionParts = fechaPublicacionInput.split('/');
    var fechaPublicacion = new Date(fechaPublicacionParts[2], fechaPublicacionParts[1] - 1, fechaPublicacionParts[0]);

    var fechaRevisionInput = $('#FechaRevision').val();
    var fechaRevisionParts = fechaRevisionInput.split('/');
    var fechaRevision = new Date(fechaRevisionParts[2], fechaRevisionParts[1] - 1, fechaRevisionParts[0]);

    var fechaEntradaEnVigorInput = $('#Fechadeentradaenvigor').val();
    var fechaEntradaEnVigorParts = fechaEntradaEnVigorInput.split('/');
    var fechaEntradaEnVigor = new Date(fechaEntradaEnVigorParts[2], fechaEntradaEnVigorParts[1] - 1, fechaEntradaEnVigorParts[0]);

    var fechaVencimientoInput = $('#FechaVencimiento').val();
    var fechaVencimientoParts = fechaVencimientoInput.split('/');
    var fechaVencimiento = new Date(fechaVencimientoParts[2], fechaVencimientoParts[1] - 1, fechaVencimientoParts[0]);

    if (fechaPublicacion.getTime() >= fechaRevision.getTime()) {
        if (fechaPublicacion.getTime() < fechaEntradaEnVigor.getTime()) {
            if (fechaPublicacion.getTime() < fechaVencimiento.getTime()) {
                result = true;
            } else {
                $.notify("La Fecha de Publicación debe ser menor a la Fecha de Vencimiento.", "warn");
            }
        } else {
            $.notify("La Fecha de Publicación debe ser menor a la Fecha de entrada en vigor.", "warn");
        }
    } else {
        $.notify("La Fecha de Publicación debe ser mayor a la Fecha de Revisión.", "warn");
    }

    return result;
}
function validarFechadeentradaenvigor() {
    var result = false;

    var fechaEntradaEnVigorInput = $('#Fechadeentradaenvigor').val();
    var fechaEntradaEnVigorParts = fechaEntradaEnVigorInput.split('/');
    var fechaEntradaEnVigor = new Date(fechaEntradaEnVigorParts[2], fechaEntradaEnVigorParts[1] - 1, fechaEntradaEnVigorParts[0]);

    var fechaRevisionInput = $('#FechaRevision').val();
    var fechaRevisionParts = fechaRevisionInput.split('/');
    var fechaRevision = new Date(fechaRevisionParts[2], fechaRevisionParts[1] - 1, fechaRevisionParts[0]);

    var fechaPublicacionInput = $('#FechaPublicacion').val();
    var fechaPublicacionParts = fechaPublicacionInput.split('/');
    var fechaPublicacion = new Date(fechaPublicacionParts[2], fechaPublicacionParts[1] - 1, fechaPublicacionParts[0]);

    var fechaVencimientoInput = $('#FechaVencimiento').val();
    var fechaVencimientoParts = fechaVencimientoInput.split('/');
    var fechaVencimiento = new Date(fechaVencimientoParts[2], fechaVencimientoParts[1] - 1, fechaVencimientoParts[0]);

    if (fechaEntradaEnVigor > fechaRevision) {
        if (fechaEntradaEnVigor > fechaPublicacion) {
            if (fechaEntradaEnVigor < fechaVencimiento) {
                result = true;
            } else {
                $.notify("La Fecha de entrada en vigor debe ser menor a la Fecha de Vencimiento.", "warn");
            }
        } else {
            $.notify("La Fecha de entrada en vigor debe ser mayor a la Fecha de Publicación.", "warn");
        }
    } else {
        $.notify("La Fecha de entrada en vigor debe ser mayor a la Fecha de Revisión.", "warn");
    }

    return result;
}
function validarFechaVencimiento() {
    var result = false;

    var fechaVencimientoInput = $('#FechaVencimiento').val();
    var fechaVencimientoParts = fechaVencimientoInput.split('/');
    var fechaVencimiento = new Date(fechaVencimientoParts[2], fechaVencimientoParts[1] - 1, fechaVencimientoParts[0]);

    var fechaRevisionInput = $('#FechaRevision').val();
    var fechaRevisionParts = fechaRevisionInput.split('/');
    var fechaRevision = new Date(fechaRevisionParts[2], fechaRevisionParts[1] - 1, fechaRevisionParts[0]);

    var fechaPublicacionInput = $('#FechaPublicacion').val();
    var fechaPublicacionParts = fechaPublicacionInput.split('/');
    var fechaPublicacion = new Date(fechaPublicacionParts[2], fechaPublicacionParts[1] - 1, fechaPublicacionParts[0]);

    var fechaEntradaEnVigorInput = $('#Fechadeentradaenvigor').val();
    var fechaEntradaEnVigorParts = fechaEntradaEnVigorInput.split('/');
    var fechaEntradaEnVigor = new Date(fechaEntradaEnVigorParts[2], fechaEntradaEnVigorParts[1] - 1, fechaEntradaEnVigorParts[0]);

    if (fechaVencimiento > fechaRevision) {
        if (fechaVencimiento > fechaPublicacion) {
            if (fechaVencimiento > fechaEntradaEnVigor) {
                result = true;
            } else {
                $.notify("La Fecha de Vencimiento debe ser mayor a la Fecha de entrada en vigor.", "warn");
            }
        } else {
            $.notify("La Fecha de Vencimiento debe ser mayor a la Fecha de Publicación.", "warn");
        }
    } else {
        $.notify("La Fecha de Vencimiento debe ser mayor a la Fecha de Revisión.", "warn");
    }

    return result;
}
function validarFechaProximaRevision() {
    var result = false;

    var fechaProximaRevisionInput = $('#FechaProximaRevision').val();
    var fechaProximaRevisionParts = fechaProximaRevisionInput.split('/');
    var fechaProximaRevision = new Date(fechaProximaRevisionParts[2], fechaProximaRevisionParts[1] - 1, fechaProximaRevisionParts[0]);

    var fechaVencimientoInput = $('#FechaVencimiento').val();
    var fechaVencimientoParts = fechaVencimientoInput.split('/');
    var fechaVencimiento = new Date(fechaVencimientoParts[2], fechaVencimientoParts[1] - 1, fechaVencimientoParts[0]);

    var fechaPublicacionInput = $('#FechaPublicacion').val();
    var fechaPublicacionParts = fechaPublicacionInput.split('/');
    var fechaPublicacion = new Date(fechaPublicacionParts[2], fechaPublicacionParts[1] - 1, fechaPublicacionParts[0]);

    if (fechaProximaRevision < fechaVencimiento) {
        if (fechaProximaRevision > fechaPublicacion) {
            result = true;
        } else {
            $.notify("La Fecha de Proxima Revisión debe ser mayor a la Fecha de Publicación.", "warn");
        }
    } else {
        $.notify("La Fecha de Proxima Revisión debe ser menor a la Fecha de Vencimiento.", "warn");
    }

    return result;
}
//FIN VALIDAR FECHAS

</script>